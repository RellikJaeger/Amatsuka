angular.module("myApp",["ngRoute","ngAnimate","ngSanitize","ngTouch","infinite-scroll","wu.masonry","toaster","ngTagsInput","myApp.controllers","myApp.filters","myApp.services","myApp.factories","myApp.directives"]).value("THROTTLE_MILLISECONDS",300).config(["$routeProvider","$locationProvider",function(t,e){return t.when("/",{templateUrl:"partials/index",controller:"IndexCtrl"}).when("/member",{templateUrl:"partials/member",controller:"MemberCtrl"}).when("/list",{templateUrl:"partials/list",controller:"ListCtrl"}).when("/find",{templateUrl:"partials/find",controller:"FindCtrl"}).when("/extract/:id?",{templateUrl:"partials/extract",controller:"ExtractCtrl"}).when("/mao",{templateUrl:"partials/mao"}).when("/like",{templateUrl:"partials/like",controller:"LikeCtrl"}).when("/config",{templateUrl:"partials/config",controller:"ConfigCtrl"}).when("/help",{templateUrl:"partials/help",controller:"HelpCtrl"}).when("/logout",{redirectTo:"/"}).when("http://127.0.0.1:4040/auth/twitter/callback",{redirectTo:"/"}).otherwise({redirectTo:"/"}),e.html5Mode(!0)}]),angular.module("myApp.controllers",[]),angular.module("myApp.directives",[]).directive("dotLoader",function(){return{restrict:"E",template:'<div class="wrapper">\n  <div class="dot"></div>\n  <div class="dot"></div>\n  <div class="dot"></div>\n</div>'}}).directive("imgPreload",function(){return{restrict:"A",link:function(t,e){e.on("load",function(){e.addClass("in")}).on("error",function(){})}}}).directive("scrollOnClick",function(){return{restrict:"A",scope:{scrollTo:"@"},link:function(t,e){return e.on("click",function(){return $("html, body").animate({scrollTop:$(t.scrollTo).offset().top},"slow")})}}}).directive("downloadFromUrl",["$q","toaster","DownloadService",function(t,e,r){return{restrict:"A",link:function(n,i,s){return i.on("click",function(){var n,i;return i=-1===s.url.indexOf("[")?[s.url]:JSON.parse(s.url),n=[],e.pop("wait","Now Downloading ...","",0,"trustedHtml"),i.forEach(function(t,e){return n.push(r.exec(t,s.filename,e))}),t.all(n).then(function(){return e.clear(),e.pop("success","Finished Download","",2e3,"trustedHtml")})})}}}]).directive("icNavAutoclose",function(){return function(t,e){var r,n;r=$(e).find(".navbar-collapse"),n=!1,r.on("show.bs.collapse",function(){n=!0}),r.on("hide.bs.collapse",function(){n=!1}),$(e).find("a").each(function(t,e){$(e).click(function(t){-1===t.target.className.indexOf("dropdown-toggle")&&n&&"auto"===r.css("overflow-y")&&r.collapse("hide")})})}}).directive("clearLocalStorage",["toaster",function(t){return{restrict:"A",link:function(e,r){return r.on("click",function(){return t.pop("wait","Now Clearing ...","",0,"trustedHtml"),window.localStorage.clear(),t.clear(),t.pop("success","Finished clearing the list data","",2e3,"trustedHtml")})}}}]),angular.module("myApp.factories",[]),angular.module("myApp.filters",[]).filter("interpolate",["version",function(t){return function(e){return String(e).replace(/\%VERSION\%/g,t)}}]).filter("noHTML",function(){return function(t){return null!=t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/,"&amp;"):void 0}}).filter("newlines",["$sce",function(t){return function(e){return t.trustAsHtml(null!=e?e.replace(/\n/g,"<br />"):"")}}]).filter("trusted",["$sce",function(t){return function(e){return t.trustAsResourceUrl(e)}}]),angular.module("myApp.services",[]),angular.module("myApp.controllers").controller("AdminUserCtrl",["$scope","$location","AuthService",function(t,e,r){return t.isLoaded=!1,t.isAuthenticated=r.status.isAuthenticated,r.status.isAuthenticated?void(t.isLoaded=!0):r.isAuthenticated().success(function(n){return _.isNull(n.data)?(t.isLoaded=!0,void e.path("/")):(r.status.isAuthenticated=!0,t.isAuthenticated=r.status.isAuthenticated,r.user=n.data,t.user=n.data,t.isLoaded=!0)}).error(function(){return void 0})}]),angular.module("myApp.controllers").controller("AmatsukaListCtrl",["AuthService","ListService",function(t,e){var r,n;if(!_.isEmpty(t.user))return n=localStorage.getItem("amatsukaList"),n="undefined"===n?{}:JSON.parse(n),r=localStorage.getItem("amatsukaFollowList"),r="undefined"===r?[]:JSON.parse(r),_.isEmpty(n)&&window.localStorage.clear(),e.amatsukaList={data:n,member:r}}]),angular.module("myApp.controllers").controller("ConfigCtrl",["$scope","$location","AuthService","ConfigService",function(t,e,r,n){return _.isEmpty(r.user)&&e.path("/"),n.getFromDB().then(function(t){return n.set(t)})["catch"](function(){return n.init()})["finally"](function(){return t.config=n.config}),t.$watch("config",function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&_.isNumber(t.likeLowerLimit)&&(n.update(),n.save2DB().then(function(){return void 0})["catch"](function(){return void 0}))},!0)}]),angular.module("myApp.controllers").controller("ExtractCtrl",["$scope","$routeParams","$location","Tweets","AuthService","TweetService","ListService","ConfigService",function(t,e,r,n,i,s,a,o){var u,c;return _.isEmpty(i.user)&&r.path("/"),a.hasListData()||r.path("/"),t.listIdStr=a.amatsukaList.data.id_str,t.layoutType="grid",t.filter={screenName:"",keyword:"",isIncludeRetweet:!1},t.extract={},t.extract.tweets=[],o.get().then(function(e){return t.layoutType=e.isTileLayout?"tile":"grid"}),u=function(e){return null==e&&(e={screenName:t.filter.screenName}),t.isLoading=!0,s.showUsers(e).then(function(e){return t.extract.user=a.normalizeMember(e.data)}).then(function(e){return s.getAllPict({twitterIdStr:e.id_str,isIncludeRetweet:t.filter.isIncludeRetweet})}).then(function(e){return _.chain(e).filter(function(e){return~e.text.indexOf(t.filter.keyword)}).value()}).then(function(e){var r;return r=s.normalizeTweets(e,a.amatsukaList.member),t.extract.tweets=r.sort(function(t,e){return e.totalNum-t.totalNum}),t.isLoading=!1})},void 0===e.id||(c=e.id.indexOf(!1)?{screenName:e.id}:{twitterIdStr:e.id},u(c)),t.execFilteringPictWithKeyword=function(){return u()},t.$on("addMember",function(e,r){s.applyFollowStatusChange(t.extract.tweets,r)}),t.$on("resize::resize",function(e,r){t.$apply(function(){t.layoutType=r.layoutType})})}]),angular.module("myApp.controllers").controller("FindCtrl",["$scope","$location","AuthService","ListService","Pict",function(t,e,r,n,i){return _.isEmpty(r.user)&&e.path("/"),n.hasListData()||e.path("/"),t.pictList=new i}]),angular.module("myApp.controllers").controller("HelpCtrl",["$scope","$location","AuthService",function(t,e,r){return _.isEmpty(r.user)?e.path("/"):void 0}]),angular.module("myApp.controllers").controller("IndexCtrl",["$scope","$location","AuthService","TweetService","ListService","ConfigService","Tweets",function(t,e,r,n,i,s,a){var o;if(!_.isEmpty(r.user))return _.isEmpty(i.amatsukaList.data)&&window.localStorage.clear(),t.listIdStr="",t.isLoaded=!1,t.layoutType="grid",s.get().then(function(e){return t.layoutType=e.isTileLayout?"tile":"grid"}),t.message="リストデータの確認中",o=function(){return t.message="リストデータの更新中",i.update().then(function(){t.tweets=new a([])})["catch"](function(){return t.message="リストを作成中",i.init().then(function(){return s.init(),s.save2DB()}).then(function(){return t.tweets=new a([])})})["finally"](function(){return t.message=""})},i.isSameAmatsukaList().then(function(e){return e?(t.tweets=new a([]),void function(){i.update().then(function(){return void 0})}()):o()})["catch"](function(){return void 0})["finally"](function(){s.getFromDB().then(function(e){return t.config=e}),t.listIdStr=i.amatsukaList.data.id_str,t.isLoaded=!0,t.message=""}),t.$on("addMember",function(e,r){n.applyFollowStatusChange(t.tweets.items,r)}),t.$on("resize::resize",function(e,r){t.$apply(function(){t.layoutType=r.layoutType})})}]),angular.module("myApp.controllers").controller("LikeCtrl",["$scope","$location","AuthService","ConfigService","TweetService","ListService","Tweets",function(t,e,r,n,i,s,a){return _.isEmpty(r.user)&&e.path("/"),s.hasListData()||e.path("/"),t.isLoaded=!1,n.get().then(function(e){return t.layoutType=e.isTileLayout?"tile":"grid"}),t.tweets=new a([],void 0,"like",r.user._json.id_str),t.listIdStr=s.amatsukaList.data.id_str,t.isLoaded=!0,t.$on("addMember",function(e,r){i.applyFollowStatusChange(t.tweets.items,r)}),t.$on("resize::resize",function(e,r){t.$apply(function(){t.layoutType=r.layoutType})})}]),angular.module("myApp.controllers").controller("ListCtrl",["$scope","$location","AuthService","TweetService","ListService","List","Member","AmatsukaList",function(t,e,r,n,i,s,a,o){return _.isEmpty(r.user)&&e.path("/"),i.hasListData()||e.path("/"),t.amatsukaList=new o("Amatsuka"),n.getListsList(r.user._json.id_str).then(function(e){var n,i;return n=_.reject(e.data,function(t){return t.full_name==="@"+r.user.username+"/amatsuka"}),t.ownList=n||[],i={name:"friends",full_name:"friends",id_str:r.user.id_str,uri:"/following"},t.ownList.push(i)})["catch"](function(){return void 0}),t.$watch("sourceListData",function(e){return null!=(null!=e?e.name:void 0)?function(){t.sourceList={},t.sourceList="friends"===e.name?new a(e.name,r.user._json.id_str):new s(e.name,e.id_str),t.sourceList.loadMember()}():void 0}),t.$on("list:addMember",function(){t.amatsukaList.updateAmatsukaList()}),t.$on("list:copyMember",function(){t.amatsukaList.updateAmatsukaList(),t.sourceList.members=i.changeFollowStatusAllMembers(t.sourceList.members,!0),$(".btn-follow").each(function(){return this.innerText="フォロー解除"})}),t.$on("list:removeMember",function(){t.amatsukaList.updateAmatsukaList()})}]),angular.module("myApp.controllers").controller("MemberCtrl",["$scope","$location","AuthService","ListService","AmatsukaList",function(t,e,r,n,i){return _.isEmpty(r.user)&&e.path("/"),n.hasListData()||e.path("/"),t.list=new i("Amatsuka"),t.$watch("searchWord.screen_name",function(e,r){var n,i,s,a,o,u;if(e!==r){if(""!==e)return s=e.toLowerCase(),t.list.members=t.list.amatsukaMemberList.filter(function(t){return-1!==t.screen_name.toLowerCase().indexOf(s)});for(t.list.members=[],t.list.memberIdx=0,u=t.list.amatsukaMemberList,n=a=0,o=u.length;o>a;n=++a){if(i=u[n],n>20)return;t.list.members.push(i),t.list.memberIdx++}}})}]),angular.module("myApp.controllers").controller("UserSidebarCtrl",["$scope","$location","ConfigService","TweetService","ListService","Tweets",function(t,e,r,n,i,s){return t.isOpened=!1,t.config={},t.$on("showUserSidebar::userData",function(e,r){t.isOpened&&(t.user=i.normalizeMember(r),t.listIdStr=i.amatsukaList.data.id_str)}),t.$on("showUserSidebar::tweetData",function(e,i){var a,o;t.isOpened&&(r.getFromDB().then(function(e){return t.config=e}),a=null!=_.last(i)?n.decStrNum(_.last(i).id_str):0,o=n.normalizeTweets(i),t.tweets=new s(o,a,"user_timeline",t.user.id_str))}),t.$on("showUserSidebar::isOpened",function(){t.isOpened=!0,t.user={},t.tweets={}}),t.$on("showUserSidebar::isClosed",function(){t.isOpened=!1,t.user={},t.tweets={}}),t.$on("addMember",function(e,r){_.isUndefined(t.tweets)||n.applyFollowStatusChange(t.tweets.items,r)})}]),angular.module("myApp.directives").directive("copyMember",["$rootScope","toaster","TweetService",function(t,e){return{restrict:"A",scope:{sourceList:"="},link:function(r,n){return n.on("click",function(){return n.hasClass("disabled")?void 0:window.confirm("コピーしてもよろしいですか？")?(n.addClass("disabled"),e.pop("wait","Now Copying ...","",0,"trustedHtml"),r.sourceList.copyMember2AmatsukaList().then(function(r){return n.removeClass("disabled"),e.clear(),t.$broadcast("list:copyMember",r),e.pop("success","Finished copy member","",2e3,"trustedHtml")})):void 0})}}}]),angular.module("myApp.directives").directive("resize",["$timeout","$rootScope","$window","ConfigService",function(t,e,r,n){return{link:function(){var i;return i=!1,angular.element(r).on("load resize",function(){i&&t.cancel(i),i=t(function(){var t,r;return r=angular.element(document).find("html"),t=r[0].clientWidth,n.get().then(function(r){var n;return n=700>t?"list":r.isTileLayout?"tile":"grid",e.$broadcast("resize::resize",{layoutType:n})})},200)})}}}]),angular.module("myApp.directives").directive("showStatuses",["$compile","$swipe","TweetService","WindowScrollableSwitcher","ZoomImageViewer",function(t,e,r,n,i){return{restrict:"A",link:function(s,a,o){return a.on("click",function(){var a,u,c,l,d,m,f,p,h,g,w,v,b,y,S,L;return n.disableScrolling(),y=null,p=0,L=new i,L.pipeLowToHighImage(o.imgSrc,o.imgSrc.replace(":small","")+":orig"),d=angular.element(document).find("html"),m=angular.element(document).find(".image-layer"),f=angular.element(document).find(".image-layer__container"),f.on("click",function(){return u()}),h=null,g=null,r.showStatuses({tweetIdStr:o.tweetIdStr}).then(function(t){return y=t.data,a(),p=l(y,o.imgSrc.replace(":small","")),v(y,p),S(y,p)}),S=function(t,e){var r,n;return n=t.extended_entities.media.length,r=angular.element(document).find(".image-layer__counter"),r.length?void r.html(""+(e+1)+" / "+n):(d='<div class="image-layer__counter">\n  '+(e+1)+" / "+n+"\n</div>",f.after(d))},w=function(){return d='<div class="image-layer__prev">\n  <i class="fa fa-angle-left fa-2x feeding-arrow"></i>\n</div>\n<div class="image-layer__next">\n  <i class="fa fa-angle-right fa-2x feeding-arrow feeding-arrow-right__patch"></i>\n</div>',f.after(d)},v=function(e,r){var n,i;return n='<div class="image-layer__caption">\n  <div class="timeline__footer">\n    <div class="timeline__footer__contents">\n      <div class="timeline__footer__controls">\n        <a href="'+e.extended_entities.media[r].expanded_url+'" target="_blank">\n          <i class="fa fa-twitter icon-twitter"></i>\n        </a>\n        <i class="fa fa-retweet icon-retweet" tweet-id-str="'+e.id_str+'" retweeted="'+e.retweeted+'" retweetable="retweetable"></i>\n        <i class="fa fa-heart icon-heart" tweet-id-str="'+e.id_str+'" favorited="'+e.favorited+'" favoritable="favoritable"></i>\n        <a>\n          <i class="fa fa-download" data-url="'+e.extended_entities.media[r].media_url_https+':orig" filename="'+e.user.screen_name+"_"+e.id_str+'" download-from-url="download-from-url"></i>\n        </a>\n      </div>\n    </div>\n  </div>\n</div>',_.isEmpty(m.html())?void 0:(i=t(n)(s).hide().fadeIn(300),m.append(i))},l=function(t,e){return _.findIndex(t.extended_entities.media,{media_url_https:e})},c=function(t,e){return"next"===t?(e+1)%y.extended_entities.media.length:"prev"===t?(e-=1,0>e?y.extended_entities.media.length-1:e):void 0},b=function(t){var e;return p=c(t,p),e=y.extended_entities.media[p].media_url_https,S(y,p),L.pipeLowToHighImage(""+e+":small",""+e+":orig")},a=function(){var t;return Mousetrap.bind("d",function(){return angular.element(document).find(".image-layer__caption .fa-download").click()}),Mousetrap.bind("f",function(){return angular.element(document).find(".image-layer__caption .icon-heart").click()}),Mousetrap.bind("l",function(){return angular.element(document).find(".image-layer__caption .icon-heart").click()}),Mousetrap.bind("r",function(){return angular.element(document).find(".image-layer__caption .icon-retweet").click()}),Mousetrap.bind("t",function(){return angular.element(document).find(".image-layer__caption .fa-twitter").click()}),Mousetrap.bind(["esc","q"],function(){return u()}),y.extended_entities.media.length<2?void 0:(w(),h=angular.element(document).find(".image-layer__next"),g=angular.element(document).find(".image-layer__prev"),h.on("click",function(){return b("next")}),g.on("click",function(){return b("prev")}),Mousetrap.bind(["left","k"],function(){return b("prev")}),Mousetrap.bind(["right","j"],function(){return b("next")}),t={},e.bind(L.getImageLayerImg(),{start:function(e){return t=e},move:function(){return void 0},end:function(e){return 0!==Math.abs(t.y-e.y)?(b(t.x>e.x?"next":"prev"),t={}):void 0},cancel:function(){return u()}}),f.on("wheel",function(t){var e;return e=t.originalEvent.wheelDelta>=0?"prev":"next",b(e)}))},u=function(){return Mousetrap.unbind(["left","right","esc","d","f","j","k","l","q","r","t"]),L.getImageLayerImg().unbind("mousedown mousemove mouseup touchstart touchmove touchend touchcancel"),m.html(""),f.html(""),null!=h&&h.remove(),null!=g&&g.remove(),n.enableScrolling(),L.cleanup(),L=null}})}}}]),angular.module("myApp.directives").directive("showUserSidebar",["$rootScope","TweetService","WindowScrollableSwitcher",function(t,e,r){return{restrict:"A",scope:{twitterIdStr:"@"},link:function(n,i){var s;return s=function(){return e.showUsers({twitterIdStr:n.twitterIdStr}).then(function(r){return t.$broadcast("showUserSidebar::userData",r.data),e.getUserTimeline({twitterIdStr:n.twitterIdStr})}).then(function(e){return t.$broadcast("showUserSidebar::tweetData",e.data)})},i.on("click",function(){var e,n,i,a,o,u;return t.$broadcast("showUserSidebar::isOpened",!0),e=angular.element(document),i=e.find(".user-sidebar"),a=e.find(".user-sidebar__header"),(o=-1!==i[0].className.indexOf(".user-sidebar--in"))?void s():(i.addClass("user-sidebar--in"),a.removeClass("user-sidebar__controll--out"),n=e.find("body"),n.addClass("scrollbar-y-hidden"),r.disableScrolling(),u=e.find(".layer"),u.addClass("fullscreen-overlay"),s(),u.on("click",function(){n.removeClass("scrollbar-y-hidden"),u.removeClass("fullscreen-overlay"),i.removeClass("user-sidebar--in"),a.addClass("user-sidebar__controll--out"),r.enableScrolling(),t.$broadcast("showUserSidebar::isClosed",!0)}))})}}}]);var TermPaginationController;angular.module("myApp.directives").directive("termPagination",function(){return{restrict:"E",scope:{},template:'<div class="pagination__term">\n  <div class="pagination__button">\n    <a class="pagination__term--prev" ng-click="$ctrl.paginate(-1)"><</a>\n  </div>\n  <a class="pagination__term--active">{{$ctrl.date}}   【{{$ctrl.total}}】</a>\n  <div class="pagination__button">\n    <a class="pagination__term--next" ng-click="$ctrl.paginate(1)">></a>\n  </div>\n</div>',bindToController:{term:"=",total:"="},controller:TermPaginationController,controllerAs:"$ctrl"}}),TermPaginationController=function(){function t(t,e,r,n){var i;this.$scope=t,this.TimeService=e,this.TermPeginateDataServicve=r,i=new n,_.isEmpty(i.queryParams)&&(i.queryParams.date=moment().subtract(1,"days").format("YYYY-MM-DD")),this.date=this.TimeService.normalizeDate("days",i.queryParams.date),this.subscribe(),this.bindKeyAction(),this.$scope.$on("$destroy",function(t){return function(){return t.unbindKeyAction()}}(this))}return t.prototype.bindKeyAction=function(){return Mousetrap.bind(["ctrl+left"],function(t){return function(){return t.paginate(-1)}}(this)),Mousetrap.bind(["ctrl+right"],function(t){return function(){return t.paginate(1)}}(this))},t.prototype.unbindKeyAction=function(){return Mousetrap.unbind(["ctrl+left","ctrl+right"])},t.prototype.subscribe=function(){return this.$scope.$on("TermPeginateDataServicve::publish",function(t){return function(e,r){return t.date=r.date}}(this))},t.prototype.paginate=function(t){return this.date=this.TimeService.changeDate("days",this.date,t),this.TermPeginateDataServicve.publish({date:this.date}),this.$scope.$emit("termPagination::paginate",{date:this.date})},t}(),TermPaginationController.$inject=["$scope","TimeService","TermPeginateDataServicve","URLParameterChecker"],angular.module("myApp.directives").directive("favoritable",["TweetService",function(t){return{restrict:"A",scope:{favNum:"=",favorited:"=",tweetIdStr:"@"},link:function(e,r){return e.favorited&&r.addClass("favorited"),r.on("click",function(){return e.favorited?(r.removeClass("favorited"),t.destroyFav({tweetIdStr:e.tweetIdStr}).then(function(){return e.favNum-=1,e.favorited=!e.favorited})):(r.addClass("favorited"),t.createFav({tweetIdStr:e.tweetIdStr}).then(function(){return e.favNum+=1,e.favorited=!e.favorited}))})}}}]).directive("retweetable",["TweetService",function(t){return{restrict:"A",scope:{retweetNum:"=",retweeted:"=",tweetIdStr:"@"},link:function(e,r){return e.retweeted&&r.addClass("retweeted"),r.on("click",function(){return e.retweeted?(r.removeClass("retweeted"),t.destroyStatus({tweetIdStr:e.tweetIdStr}).then(function(){return e.retweetNum-=1,e.retweeted=!e.retweeted})):window.confirm("リツイートしてもよろしいですか？")?(r.addClass("retweeted"),t.retweetStatus({tweetIdStr:e.tweetIdStr}).then(function(){return e.retweetNum+=1,e.retweeted=!e.retweeted})):void 0})}}}]).directive("followable",["$rootScope","ListService","TweetService",function(t,e,r){return{restrict:"E",replace:!0,scope:{listIdStr:"@",twitterIdStr:"@",followStatus:"="},template:'<span class="label label-default timeline__header__label">{{content}}</span>',link:function(n,i){return n.followStatus===!1&&(n.content="+"),i.on("mouseover",function(){return n.content="フォロー",n.$apply()}),i.on("mouseout",function(){return n.content="+",n.$apply()}),i.on("click",function(){var s;return s={listIdStr:n.listIdStr,twitterIdStr:n.twitterIdStr},n.followStatus===!1?(i.addClass("label-success"),i.fadeOut(200),r.createListsMembers(s).then(function(){return e.addMember(n.twitterIdStr),t.$broadcast("addMember",n.twitterIdStr),r.collectProfile({twitterIdStr:n.twitterIdStr})}).then(function(){return void 0})):void 0})}}}]).directive("followable",["$rootScope","ListService","TweetService",function(t,e,r){return{restrict:"A",scope:{listIdStr:"@",twitterIdStr:"@",followStatus:"="},link:function(n,i){return i[0].innerText=n.followStatus?"フォロー解除":"フォロー",i.on("click",function(){var s;return s={listIdStr:n.listIdStr,twitterIdStr:n.twitterIdStr},n.isProcessing=!0,n.followStatus===!0&&(i[0].innerText="フォロー",r.destroyListsMembers(s).then(function(r){return e.removeMember(n.twitterIdStr),t.$broadcast("list:removeMember",r),n.isProcessing=!1})),n.followStatus===!1&&(i[0].innerText="フォロー解除",r.createListsMembers(s).then(function(i){return e.addMember(n.twitterIdStr),t.$broadcast("addMember",n.twitterIdStr),t.$broadcast("list:addMember",i),n.isProcessing=!1,r.collectProfile({twitterIdStr:n.twitterIdStr})}).then(function(){return void 0})),n.followStatus=!n.followStatus})}}}]),angular.module("myApp.directives").directive("zoomImage",["$compile","$rootScope","TweetService","GetterImageInfomation",function(t,e,r,n){return{restrict:"A",link:function(t,e,r){return e.on("click",function(){var t,e,i,s,a;return e=angular.element(document).find(".image-layer"),t='<div class="image-layer__container">\n  <img class="image-layer__img"/>\n  <div class="image-layer__loading">\n    <img src="./images/loaders/tail-spin.svg" />\n  </div>\n</div>',e.html(t),e.addClass("image-layer__overlay"),s=angular.element(document).find(".image-layer__img"),a=angular.element(document).find(".image-layer__loading"),s.hide(),s.attr("src",(""+r.imgSrc).replace(":small",":orig")).load(function(){var t;return t=n.getWideDirection(s),s.addClass("image-layer__img-"+t+"-wide"),a.remove(),s.fadeIn(1)}),i=angular.element(document).find(".image-layer__container"),i.on("click",function(){return e.html(""),e.removeClass("image-layer__overlay")})})}}}]),angular.module("myApp.factories").factory("AmatsukaList",["TweetService","ListService",function(t,e){var r;return r=function(){function t(t){this.name=t,this.isLast=!1,this.count=20,this.members=[],this.memberIdx=0,this.idStr=(JSON.parse(localStorage.getItem("amatsukaList"))||{}).id_str,this.amatsukaMemberList=e.normalizeMembers(JSON.parse(localStorage.getItem("amatsukaFollowList")))||[],this.amatsukaMemberLength=this.amatsukaMemberList.length}return t.prototype.updateAmatsukaList=function(){return e.update().then(function(t){return function(r){return t.idstr=e.amatsukaList.data.id_str,t.amatsukaMemberList=e.normalizeMembers(r),t.amatsukaMemberLength=t.amatsukaMemberList.length,t.length=t.amatsukaMemberLength,t.isLast=!0,void(t.members=t.amatsukaMemberList)}}(this))},t.prototype.loadMoreMember=function(){this.isLast||(this.members=this.members.concat(this.amatsukaMemberList.slice(this.memberIdx,this.memberIdx+this.count)),this.memberIdx+=this.count,this.memberIdx>this.amatsukaMemberLength&&(this.isLast=!0))},t}()}]),angular.module("myApp.factories").factory("BlackUserList",["TweetService","BlackUserListService",function(t,e){var r;return r=function(){function r(){this.blockUserList=[],this.blockOpts={method:"blocks",type:"list",cursor:-1}}return r.prototype.setBlockUserList=function(){return t.getViaAPI(this.blockOpts).then(function(t){return function(r){return null!=data.error&&reject(data.error),t.blockUserList=t.blockUserList.concat(r.data.users),0===r.data.users.length?(localStorage.setItem("amatsuka.blockUserList",JSON.stringify(t.blockUserList)),void(e.block=t.blockUserList)):(t.blockOpts.cursor=r.data.next_cursor_str,t.setBlockUserList())}}(this))["catch"](function(){return function(){}}(this))},r}()}]);var __hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var n in e)__hasProp.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};angular.module("myApp.factories").factory("List",["$q","toaster","TweetService","ListService","Member",function(t,e,r,n,i){var s;return s=function(t){function e(t,r){e.__super__.constructor.call(this,t,r)}return __extends(e,t),e.prototype.loadMember=function(){return r.getListsMembers({listIdStr:this.idStr,count:1e3}).then(function(t){return function(e){return t.members=n.normalizeMembersForCopy(e.data.users)}}(this))},e}(i)}]);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};angular.module("myApp.factories").factory("Mao",["$q","$httpParamSerializer","ListService","MaoService","TweetService",function(t,e,r,n,i){var s;return s=function(){function t(t){this.date=t,this.normalizeTweets=__bind(this.normalizeTweets,this),this.busy=!1,this.isLast=!1,this.limit=30,this.skip=0,this.items=[],this.isAuthenticatedWithMao=!0}return t.prototype.normalizeTweets=function(t){return new Promise(function(){return function(e){var n,s;return t=t.map(function(t){return JSON.parse(t.tweetStr)}),s=i.normalizeTweets(t,r.amatsukaList.member),n=s.map(function(t){return t.extended_entities.media.map(function(e){return{tweet:t,media:e}})}),e(_.flatten(n))}}(this))},t.prototype.load=function(){var t,r;if(!this.busy&&!this.isLast)return this.busy=!0,t={skip:this.skip,limit:this.limit,date:this.date},r=e(t),n.findByMaoTokenAndDate(r).then(function(t){return function(e){return t.normalizeTweets(e.data)}}(this)).then(function(t){return function(e){return 0===e.length?(t.busy=!1,void(t.isLast=!0)):(e.forEach(function(e){return t.items.push(e)}),t.skip+=t.limit,t.busy=!1)}}(this))["catch"](function(t){return function(){return t.isLast=!0,t.busy=!1,t.isAuthenticatedWithMao=!1}}(this))},t}()}]),angular.module("myApp.factories").factory("Member",["$q","toaster","TweetService","ListService",function(t,e,r,n){var i;return i=function(){function e(t,e){this.name=t,this.idStr=e,this.isLast=!1,this.count=20,this.nextCursor=-1,this.members=[],this.memberIdx=0,this.amatsukaListIdStr=n.amatsukaList.data.id_str}return e.prototype.loadMember=function(){return r.getFollowingList({twitterIdStr:this.idStr,nextCursor:this.nextCursor,count:200}).then(function(t){return function(e){return _.isEmpty(e.data.users)||(t.members=t.members.concat(n.normalizeMembersForCopy(e.data.users)),t.nextCursor=e.data.next_cursor_str,0===e.data.next_cursor)?void 0:t.loadMember()}}(this))},e.prototype.copyMember2AmatsukaList=function(){return t(function(t){return function(e,n){var i;return 0===t.members.length?n("member is nothing"):(i="",_.each(t.members,function(t){return i+=""+t.id_str+","}),r.createAllListsMembers({listIdStr:t.amatsukaListIdStr,twitterIdStr:i}).then(function(t){return e(t)})["catch"](function(t){return n(t)}))}}(this))},e}()}]),angular.module("myApp.factories").factory("Pict",["$q","toaster","TweetService",function(t,e,r){var n;return n=function(){function t(){this.busy=!1,this.isLast=!1,this.limit=10,this.skip=0,this.items=[],this.numIllustorator=0,this.numMaxSkip=0,this.doneSkip=[]}return t.prototype.randomAccess=function(){for(var t;;)if(t=_.sample(_.range(this.numMaxSkip)),!this.doneSkip.includes(t)||this.doneSkip.length>=this.numMaxSkip)break;this.doneSkip.push(t),this.skip=t*this.limit,r.getPict({skip:this.skip,limit:this.limit}).then(function(t){return function(e){return t.items=t.items.concat(e),t.skip+=t.limit,t.doneSkip.length>=t.numMaxSkip&&(t.isLast=!0),t.busy=!1}}(this))},t.prototype.load=function(){return this.busy||this.isLast?void 0:(this.busy=!0,0!==this.numIllustorator?void this.randomAccess():r.getPictCount().then(function(t){return function(e){return t.numIllustorator=e,t.numMaxSkip=(t.numIllustorator-1)/t.limit,t.randomAccess()}}(this)))},t}()}]),angular.module("myApp.factories").factory("TweetCountList",["$q","$httpParamSerializer","MaoService",function(t,e,r){var n;return n=function(){function t(t){this.date=t,this.busy=!1,this.isLast=!1,this.limit=20,this.skip=0,this.maxCount=1e3,this.items=[],this.isAuthenticatedWithMao=!0}return t.prototype.load=function(){var t,n;if(!this.busy&&!this.isLast)return this.busy=!0,t={skip:this.skip,limit:this.limit},n=e(t),r.aggregateTweetCount(n).then(function(t){return function(e){return 0===e.data.length?(t.busy=!1,void(t.isLast=!0)):(0===t.items.length&&(t.maxCount=e.data[0].postCount),e.data.map(function(e){return t.items.push(e)}),t.skip+=t.limit,t.busy=!1)}}(this))["catch"](function(t){return function(){return t.isLast=!0,t.busy=!1,t.isAuthenticatedWithMao=!1}}(this))},t}()}]);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};angular.module("myApp.factories").factory("Tweets",["$http","$q","ToasterService","TweetService","ListService",function(t,e,r,n,i){var s;return s=function(){function t(t,e,r,n){this.items=t,this.maxId=null!=e?e:void 0,this.type=r,this.twitterIdStr=null!=n?n:null,this.checkError=__bind(this.checkError,this),this.assignTweet=__bind(this.assignTweet,this),this.normalizeTweet=__bind(this.normalizeTweet,this),this.busy=!1,this.isLast=!1,this.method=null,this.count=40}return t.prototype.normalizeTweet=function(t){return new Promise(function(e){return function(r,s){var a;return null!=t.error&&s(t.error),_.isEmpty(t.data)&&s({statusCode:10100}),e.maxId=n.decStrNum(_.last(t.data).id_str),a=n.normalizeTweets(t.data,i.amatsukaList.member),r(a)}}(this))},t.prototype.assignTweet=function(t){return new Promise(function(r){return function(n,i){_.isEmpty(t)&&i({statusCode:100110}),function(){e.all(t.map(function(t){return[r.items][0].push(t)})).then(function(){return r.busy=!1})}()}}(this))},t.prototype.checkError=function(t){switch(t){case 429:r.warning({title:"ツイート取得API制限",text:"15分お待ちください"});break;case 10100:this.isLast=!0,this.busy=!1,r.success({title:"全ツイート取得完了",text:"全て読み込みました"});break;case 10110:this.busy=!1}},t.prototype.nextPage=function(){return this.busy||this.isLast?void 0:(this.method="user_timeline"===this.type?n.getUserTimeline({twitterIdStr:this.twitterIdStr,maxId:this.maxId,count:this.count}):"like"===this.type?n.getFavLists({twitterIdStr:this.twitterIdStr,maxId:this.maxId,count:this.count}):n.getListsStatuses({listIdStr:i.amatsukaList.data.id_str,maxId:this.maxId,count:this.count}),this.busy=!0,function(t){return function(){t.method.then(function(e){return t.normalizeTweet(e)}).then(function(e){return t.assignTweet(e)})["catch"](function(e){return t.checkError(e.statusCode)})}}(this)())},t}()}]),angular.module("myApp.factories").factory("URLParameterChecker",["URLParameterService",function(t){var e;return e=function(){function e(){this.urlResources=t.parse(),this.queryParams=t.getQueryParams()}return e.prototype.checkURLResourceLength=function(e){return t.checkURLResourceLength(this.urlResources.length,e)},e}()}]),angular.module("myApp.factories").factory("WindowScrollableSwitcher",function(){var t;return t=function(){function t(){}return t.enableScrolling=function(){window.onscroll=function(){}},t.disableScrolling=function(){var t,e;return t=window.scrollX,e=window.scrollY,window.onscroll=function(){return window.scrollTo(t,e)}},t}()}),angular.module("myApp.factories").factory("ZoomImageViewer",["GetterImageInfomation",function(t){var e;return e=function(){function e(){var t;this.imageLayer=angular.element(document).find(".image-layer"),t='<div class="image-layer__container">\n  <img class="image-layer__img"/>\n  <div class="image-layer__loading">\n    <img src="./images/loaders/tail-spin.svg" />\n  </div>\n</div>\n',this.imageLayer.html(t),this.imageLayer.addClass("image-layer__overlay"),this.imageLayerImg=angular.element(document).find(".image-layer__img"),this.imageLayerLoading=angular.element(document).find(".image-layer__loading")
}return e.prototype.getImageLayerImg=function(){return this.imageLayerImg},e.prototype.setImageAndStyle=function(e){var r;return r=t.getWideDirection(e),e.addClass("image-layer__img-"+r+"-wide")},e.prototype.pipeLowToHighImage=function(t,e){return this.imageLayerLoading.show(),this.imageLayerImg.hide(),this.imageLayerImg.removeClass(),this.imageLayerImg.attr("src",t).load(function(t){return function(){return t.imageLayerLoading.hide(),t.setImageAndStyle(t.imageLayerImg),t.imageLayerImg.fadeIn(1),t.imageLayerImg.off("load"),t.imageLayerImg.attr("src",e).load(function(){return t.imageLayerImg.fadeIn(1)})}}(this))},e.prototype.cleanup=function(){return this.imageLayerLoading.remove(),this.imageLayer.removeClass("image-layer__overlay")},e}()}]),angular.module("myApp.services").service("AuthService",["$http",function(t){return{isAuthenticated:function(){return t.get("/isAuthenticated")},status:{isAuthenticated:!1},user:{}}}]),angular.module("myApp.services").service("BlackUserListService",function(){return{block:[],mute:[]}}),angular.module("myApp.services").service("ConfigService",["$http","$q",function(t,e){return{config:{},set:function(t){return this.config=t},get:function(){return new Promise(function(t){return function(e){return _.isEmpty(t.config)?t.getFromDB().then(function(r){return t.set(r),e(r)}):e(t.config)}}(this))},update:function(){localStorage.setItem("amatsuka.config",JSON.stringify(this.config))},init:function(){return this.config={includeRetweet:!0,ngUsername:[],ngWord:[]},localStorage.setItem("amatsuka.config",JSON.stringify(this.config))},getFromDB:function(){return e(function(e,r){return t.get("/api/config").success(function(t){return _.isNull(t.data)?r("Not found data"):e(JSON.parse(t.data.configStr))}).error(function(t){return r(t||"getFromDB Request failed")})})},save2DB:function(){return e(function(e){return function(r,n){return t.post("/api/config",{config:e.config}).success(function(t){return r(t)}).error(function(t){return n(t||"save2DB Request failed")})}}(this))}}}]),angular.module("myApp.services").service("ConvertService",function(){return{base64toBlob:function(t){var e,r,n,i,s,a;for(i=void 0,a=t.split(","),n=atob(a[1]),s=a[0].split(":")[1].split(";")[0],e=new Uint8Array(n.length),i=0;i<n.length;)e[i]=n.charCodeAt(i),i++;return r=new Blob([e],{type:s})}}}),angular.module("myApp.services").service("DownloadService",["$http","ConvertService",function(t,e){return{exec:function(r,n,i){return t.post("/api/download",{url:r}).success(function(t){return function(s){var a,o;return a=e.base64toBlob(s.base64Data),o=/media\/.*\.(png|jpg|jpeg):orig/.exec(r)[1],n=""+n+"_"+i+"."+o,t.saveAs(a,n)}}(this))},saveAs:function(t,e){var r;return navigator.appVersion.toString().indexOf(".NET")>0?window.navigator.msSaveBlob(t,e):(r=document.createElement("a"),document.body.appendChild(r),r.style="display: none",r.href=window.URL.createObjectURL(t),r.download=e,r.click())}}}]),angular.module("myApp.services").service("GetterImageInfomation",function(){return{getWideDirection:function(t){var e,r,n,i,s,a,o,u;return o=angular.element(document).find("html"),s=t[0].naturalHeight,u=t[0].naturalWidth,a=s/u*100,e=o[0].clientHeight,n=o[0].clientWidth,r=e/n*100,i=a-r>=0?"h":"w"}}}),angular.module("myApp.services").service("ListService",["$http","$q","AuthService","TweetService",function(t,e,r,n){return{amatsukaList:{data:[],member:{}},registerMember2LocalStorage:function(){localStorage.setItem("amatsukaFollowList",JSON.stringify(this.amatsukaList.member))},addMember:function(t){return n.showUsers({twitterIdStr:t}).then(function(t){return function(e){return t.amatsukaList.member.push(e.data),t.registerMember2LocalStorage()}}(this))},removeMember:function(t){this.amatsukaList.member=_.reject(this.amatsukaList.member,{id_str:t}),this.registerMember2LocalStorage()},isFollow:function(t,e){var r;return null==e&&(e=!0),r=t.id_str,_.has(t,"user")&&(r=n.get(t,"user.id_str",e)),!!_.findWhere(this.amatsukaList.member,{id_str:r})},normalizeMembers:function(t){return _.each(t,function(t){t.followStatus=!0,t.description=n.activateLink(t.description),t.profile_image_url_https=n.iconBigger(t.profile_image_url_https)})},changeFollowStatusAllMembers:function(t,e){return _.map(t,function(t){return t.followStatus=e,t})},normalizeMember:function(t){var e,r;return e=n.getExpandedURLFromDescription(t.entities),r=n.getExpandedURLFromURL(t.entities),_.each(e,function(e){t.description=t.description.replace(e.url,e.expanded_url)}),_.each(r,function(e){t.url=t.url.replace(e.url,e.expanded_url)}),t.followStatus=this.isFollow(t),t.description=n.activateLink(t.description),t.profile_image_url_https=n.iconBigger(t.profile_image_url_https),t},normalizeMembersForCopy:function(t){return _.each(t,function(t){return function(e){e.followStatus=t.isFollow(e),e.isPermissionCopy=!0,e.profile_image_url_https=n.iconBigger(e.profile_image_url_https)}}(this))},update:function(){return n.getListsList({twitterIdStr:r.user._json.id_str}).then(function(t){return function(e){return t.amatsukaList.data=_.findWhere(e.data,{full_name:"@"+r.user.username+"/amatsuka"}),localStorage.setItem("amatsukaList",JSON.stringify(t.amatsukaList.data)),n.getListsMembers({listIdStr:t.amatsukaList.data.id_str})}}(this)).then(function(t){return function(e){return t.amatsukaList.member=e.data.users,localStorage.setItem("amatsukaFollowList",JSON.stringify(t.amatsukaList.member)),e.data.users}}(this))},init:function(){return n.createLists({name:"Amatsuka",mode:"private"}).then(function(t){return function(e){var r;return t.amatsukaList.data=e.data,localStorage.setItem("amatsukaList",JSON.stringify(e.data)),r={listIdStr:e.data.id_str,twitterIdStr:void 0},n.createAllListsMembers(r)}}(this)).then(function(t){return n.getListsMembers({listIdStr:t.data.id_str})}).then(function(t){return function(e){return t.amatsukaList.member=e.data.users,localStorage.setItem("amatsukaFollowList",JSON.stringify(e.data.users)),e.data.users}}(this))},getAmatsukaList:function(){return e(function(){return function(t){return n.getListsList({twitterIdStr:r.user._json.id_str}).then(function(e){var n;return n=e.data,t(_.findWhere(n,{full_name:"@"+r.user.username+"/amatsuka"})||{id_str:null})})}}(this))},isSameAmatsukaList:function(){return e(function(t){return function(e,r){return t.getAmatsukaList().then(function(t){var r;return r=JSON.parse(localStorage.getItem("amatsukaList"))||{},e(r.id_str===t.id_str)})["catch"](function(t){return r(t)})}}(this))},hasListData:function(){return!(_.isEmpty(this.amatsukaList.data)&&_.isEmpty(this.amatsukaList.member))}}}]),angular.module("myApp.services").service("MaoService",["$http",function(t){return{findByMaoTokenAndDate:function(e){return t.get("/api/mao?"+e)},countTweetByMaoTokenAndDate:function(e){return t.get("/api/mao/tweets/count?"+e)},aggregateTweetCount:function(e){return t.get("/api/mao/stats/tweet/count?"+e)}}}]),angular.module("myApp.services").service("StatService",["$http","$q",function(){}]),angular.module("myApp.services").service("TermPeginateDataServicve",["$rootScope",function(t){return{publish:function(e){return t.$broadcast("TermPeginateDataServicve::publish",e)}}}]),angular.module("myApp.services").service("TimeService",function(){return{normalizeDate:function(t,e){switch(t){case"days":return moment(e).format("YYYY-MM-DD");case"weeks":return moment(e).format("YYYY-MM-DD");case"month":return moment(e).date("1").format("YYYY-MM-DD");default:return moment(e).format("YYYY-MM-DD")}},changeDate:function(t,e,r){switch(t){case"days":return moment(e).add(r,"days").format("YYYY-MM-DD");case"weeks":return moment(e).add(r,"weeks").format("YYYY-MM-DD");case"month":return moment(e).add(r,"months").date("1").format("YYYY-MM-DD");default:return moment().format("YYYY-MM-DD")}}}}),angular.module("myApp.services").service("ToasterService",["toaster",function(t){return{success:function(e){return t.pop("success",e.title,e.text,2e3,"trustedHtml")},warning:function(e){return t.pop("warning",e.title,e.text,2e3,"trustedHtml")}}}]),angular.module("myApp.services").service("TweetService",["$http","$httpParamSerializer","$q","$injector","BlackUserListService","ConfigService","ToasterService","toaster",function(t,e,r,n,i,s,a,o){return{activateLink:function(t){return t.replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&amp;%@!&#45;\/]))?)/g,'<a href="$1" target="_blank">$1</a>').replace(/(^|\s)(@|＠)(\w+)/g,'$1<a href="http://www.twitter.com/$3" target="_blank">@$3</a>').replace(/(?:^|[^ーー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9&_\/>]+)[#＃]([ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9_]*[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z]+[ー゛゜々ヾヽぁ-ヶ一-龠ａ-ｚＡ-Ｚ０-９a-zA-Z0-9_]*)/g,' <a href="http://twitter.com/search?q=%23$1" target="_blank">#$1</a>')},iconBigger:function(t){return _.isUndefined(t)?this.replace("normal","bigger"):t.replace("normal","bigger")},hasOrigParameter:function(){return void 0},applyFollowStatusChange:function(t,e){return _.map(t,function(t){return function(r){var n,i;return i=_.has(r,"retweeted_status"),n=t.get(r,"user.id_str",i),n===e?r.followStatus=!0:void 0}}(this))},normalizeTweets:function(t){var e;return e=n.get("ListService"),_.map(t,function(t){return function(r){var n;return n=_.has(r,"retweeted_status"),r.isRT=n,r.followStatus=e.isFollow(r,n),r.text=t.expandTweetUrl(r,n),r.time=t.fromNow(t.get(r,"tweet.created_at",!1)),r.retweetNum=t.get(r,"tweet.retweet_count",n),r.favNum=t.get(r,"tweet.favorite_count",n),r.tweetIdStr=t.get(r,"tweet.id_str",n),r.sourceUrl=t.get(r,"display_url",n),r.picUrlList=t.get(r,"media_url_https:small",n),r.picOrigUrlList=t.get(r,"media_url_https:orig",n),r.video_url=t.get(r,"video_url",n),r.fileName=t.get(r,"screen_name",n)+"_"+t.get(r,"tweet.id_str",n),r.user.profile_image_url_https=t.iconBigger(r.user.profile_image_url_https),r}}(this))},isRT:function(t){return _.has(t,"retweeted_status")},get:function(t,e,r){var n,i,s,a,o,u,c,l,d;switch(n=r?t.retweeted_status:t,e){case"description":return n.user.description;case"display_url":return null!=(i=n.entities)&&null!=(s=i.media)?s[0].display_url:void 0;case"entities":return n.entities;case"expanded_url":return null!=(a=n.entities)&&null!=(o=a.media)?o[0].expanded_url:void 0;case"followers_count":return n.user.followers_count;case"friends_count":return n.user.friends_count;case"hashtags":return null!=(u=n.entities)?u.hashtags:void 0;case"media_url":return _.map(n.extended_entities.media,function(t){return t.media_url});case"media_url_https":return _.map(n.extended_entities.media,function(t){return t.media_url_https});case"media_url:orig":return _.map(n.extended_entities.media,function(t){return t.media_url+":orig"});case"media_url_https:orig":return _.map(n.extended_entities.media,function(t){return t.media_url_https+":orig"});case"media_url_https:small":return _.map(n.extended_entities.media,function(t){return t.media_url_https+":small"});case"video_url":return null!=(c=n.extended_entities)&&null!=(l=c.media[0])&&null!=(d=l.video_info)?d.variants[0].url:void 0;case"name":return n.user.name;case"profile_banner_url":return n.user.profile_banner_url;case"profile_image_url":return n.user.profile_image_url;case"profile_image_url_https":return n.user.profile_image_url_https;case"statuses_count":return n.user.statuses_count;case"screen_name":return n.user.screen_name;case"source":return n.source;case"text":return n.text;case"timestamp_ms":return n.timestamp_ms;case"tweet.created_at":return n.created_at;case"tweet.favorite_count":return n.favorite_count;case"tweet.retweet_count":return n.retweet_count;case"tweet.id_str":return n.id_str;case"tweet.lang":return n.lang;case"user.created_at":return n.user.created_at;case"user.id_str":return n.user.id_str;case"user.favorite_count":return n.favorite_count;case"user.retweet_count":return n.retweet_count;case"user.lang":return n.user.lang;case"user.url":return n.user.url;default:return null}},expandTweetUrl:function(t,e){var r;return t.text=this.get(t,"text",e),r=this.getExpandedURLFromTweet(t.entities),_.each(r,function(){return function(e){t.text=t.text.replace(e.url,e.expanded_url)}}(this)),t.text=this.activateLink(t.text),t.text},getExpandedURLFromTweet:function(t){return _.has(t,"urls")?t.urls:""},getExpandedURLFromURL:function(t){return _.has(t,"url")?t.url.urls:""},getExpandedURLFromDescription:function(t){return _.has(t,"description")&&_.has(t.description,"urls")?t.description.urls:""},decStrNum:function(t){var e,r;for(t=t.toString(),r=t,e=t.length-1;e>-1;){if("0"!==t[e])return r=r.substring(0,e)+(parseInt(t[e],10)-1).toString()+r.substring(e+1);r=r.substring(0,e)+"9"+r.substring(e+1),e--}return r},fromNow:function(t){return moment(t).fromNow(!0)},filterIncludeImage:function(t){return _.reject(t,function(t){return!_.has(t,"extended_entities")||_.isEmpty(t.extended_entities.media)})},collectProfile:function(e){return r(function(r,n){return t.post("/api/collect/profile",e).success(function(t){return r(t)}).error(function(t){return n(t)})})},getPict:function(e){return r(function(r,n){return t.get("/api/collect/"+e.skip+"/"+e.limit).success(function(t){return r(t)}).error(function(t){return n(t)})})},getPictCount:function(){return r(function(e,r){return t.get("/api/collect/count").success(function(t){return e(t.count)}).error(function(t){return r(t)})})},getAllPict:function(t){return r(function(e){return function(r){var n,i,s;return s=[],i=i||0,(n=function(){return e.getUserTimeline({twitterIdStr:t.twitterIdStr,maxId:i,count:200,isIncludeRetweet:t.isIncludeRetweet}).then(function(t){return _.isUndefined(t.data)?(o.pop("error","API制限。15分お待ち下さい。"),r(s)):0===t.data.length?(o.pop("success","最後まで読み終えました。"),r(s)):(i=e.decStrNum(t.data[t.data.length-1].id_str),_.each(t.data,function(t){t.totalNum=t.retweet_count+t.favorite_count,t.tweetIdStr=t.id_str}),s=s.concat(t.data),n())})})()}}(this))},checkError:function(t){switch(t){case 429:a.warning({title:"API制限",text:"15分お待ちください"})}},getViaAPI:function(n){var i;return null==n&&(n={}),i=e(n),r(function(e,r){return t.get("/api/twitter?"+i).success(function(t){return e(t)}).error(function(t){return r(t)})})},getListsList:function(e){return r(function(r){return function(n,i){return t.get("/api/lists/list/"+e.twitterIdStr).success(function(t){return _.has(t,"error")?(r.checkError(t.error.statusCode),i(t)):n(t)}).error(function(t){return i(t)})}}(this))},createLists:function(e){return r(function(r,n){return t.post("/api/lists/create",e).success(function(t){return r(t)}).error(function(t){return n(t)})})},getListsMembers:function(e){return r(function(r,n){return t.get("/api/lists/members/"+e.listIdStr+"/"+e.count).success(function(t){return r(t)}).error(function(t){return n(t)})})},getListsStatuses:function(e){return r(function(r,n){return t.get("/api/lists/statuses/"+e.listIdStr+"/"+e.maxId+"/"+e.count).success(function(t){return r(t)}).error(function(t){return n(t)})})},createListsMembers:function(e){return r(function(r,n){return t.post("/api/lists/members/create",e).success(function(t){return r(t)}).error(function(t){return n(t)})})},createAllListsMembers:function(e){return r(function(r,n){return t.post("/api/lists/members/create_all",e).success(function(t){return r(t)}).error(function(t){return n(t)})})},destroyListsMembers:function(e){return r(function(r){return t.post("/api/lists/members/destroy",e).success(function(t){return r(t)})})},getUserTimeline:function(e){return r(function(r,n){return t.get("/api/timeline/"+e.twitterIdStr+"/"+e.maxId+"/"+e.count+"?isIncludeRetweet="+e.isIncludeRetweet).success(function(t){return r(t)}).error(function(t){return n(t)})})},getFollowingList:function(e){return r(function(r){return t.get("/api/friends/list/"+e.twitterIdStr+"/"+e.count).success(function(t){return r(t)})})},showStatuses:function(e){return r(function(r){return t.get("/api/statuses/show/"+e.tweetIdStr).success(function(t){return r(t)})})},showUsers:function(e){return r(function(r){return t.get("/api/users/show/"+e.twitterIdStr+"/"+e.screenName).success(function(t){return r(t)})})},getFavLists:function(e){return r(function(r){return t.get("/api/favorites/lists/"+e.twitterIdStr+"/"+e.maxId+"/"+e.count).success(function(t){return r(t)})})},createFav:function(e){return r(function(r){return t.post("/api/favorites/create",e).success(function(t){return r(t)})})},destroyFav:function(e){return r(function(r){return t.post("/api/favorites/destroy",e).success(function(t){return r(t)})})},retweetStatus:function(e){return r(function(r){return t.post("/api/statuses/retweet",e).success(function(t){return r(t)})})},destroyStatus:function(e){return r(function(r){return t.post("/api/statuses/destroy",e).success(function(t){return r(t)})})}}}]),angular.module("myApp.services").service("URLParameterService",["$location",function(t){return{checkURLResourceLength:function(e,r){return e>r?t.path("/"):void 0},getQueryParams:function(){return t.search()},parse:function(){return t.path().split("/")}}}]);var MaoContainerController;angular.module("myApp.directives").directive("maoContainer",function(){return{restrict:"E",scope:{},template:'<ul class="nav nav-pills nav-stacked col-md-1 col-sm-2">\n  <li ng-repeat="tab in $ctrl.tabs" ng-class="{active: tab.active}">\n    <a href="{{tab.href}}" data-toggle="tab" ng-click="$ctrl.select(tab.id)" >{{tab.name}}</a>\n  </li>\n</ul>\n<div class="tab-content col-md-11 col-sm-10">\n  <div id="tweets" class="row tab-pane active" ng-if="$ctrl.tabType == \'tweets\'">\n    <mao-list-container></mao-list-container>\n  </div>\n  <div id="stats" class="row tab-pane" ng-if="$ctrl.tabType == \'stats\'">\n    <mao-ranking-post-number></mao-ranking-post-number>\n  </div>\n</div>',bindToController:{},controllerAs:"$ctrl",controller:MaoContainerController}}),MaoContainerController=function(){function t(){this.tabs=[{href:"#tweets",id:"tweets",name:"Tweets",active:!0},{href:"#stats",id:"stats",name:"Stats",active:!1}],this.tabType=this.tabs[0].id}return t.prototype.select=function(t){return this.tabType=t,this.tabs.forEach(function(e){return void(e.active=e.id===t?!0:!1)})},t}();var MaoListContoller;angular.module("myApp.directives").directive("maoListContainer",function(){return{restrict:"E",scope:{},template:'<dot-loader ng-if="!$ctrl.tweetList.items" class="user-sidebar__contents--box-loading-init">\n</dot-loader>\n<div ng-if="$ctrl.tweetList.isAuthenticatedWithMao">\n\n  <div class="col-sm-12">\n    <term-pagination total="$ctrl.tweetTotalNumber"></term-pagination>\n  </div>\n\n  <div infinite-scroll="$ctrl.tweetList.load()" infinite-scroll-distance="0">\n    <div ng-repeat="item in $ctrl.tweetList.items" class="col-lg-2 col-md-3 col-sm-4 col-xs-6 mao__tweet__container">\n      <mao-tweet-article item="item"></mao-tweet-article>\n    </div>\n  </div>\n\n  <div class="col-sm-12">\n    <dot-loader ng-if="$ctrl.tweetList.busy" class="infinitescroll-content">\n    </dot-loader>\n    <div ng-show="$ctrl.tweetList.isLast" class="text-center infinitescroll-content infinitescroll-message">終わりです\n    </div>\n  </div>\n\n  <div class="col-sm-12 pagination__term__container--bottom">\n    <term-pagination total="$ctrl.tweetTotalNumber"></term-pagination>\n  </div>\n\n</div>\n<div ng-if="!$ctrl.tweetList.isAuthenticatedWithMao" class="col-sm-12">\n  <div class="infinitescroll-message">\n    <p>MaoでのTwitter認証がされていないのでこの機能は利用できません。</p>\n    <p>MaoはAmatsukaのメンバーの人気の画像を毎日収集し、閲覧できる機能です。</p>\n    <p>認証は以下のリンク先で行えます</p>\n    <p>\n      <a href="https://ma0.herokuapp.com" target="_blank" class="mao__link">\n        Mao\n        <i class="fa fa-external-link"></i>\n      </a>\n    </p>\n  </div>\n</div>',bindToController:{},controllerAs:"$ctrl",controller:MaoListContoller}}),MaoListContoller=function(){function t(t,e,r,n,i,s,a){var o,u;this.$location=t,this.$httpParamSerializer=e,this.$scope=r,this.Mao=n,this.MaoService=i,this.TimeService=a,u=new s,_.isEmpty(u.queryParams)&&(u.queryParams.date=moment().add(-1,"days").format("YYYY-MM-DD")),this.date=moment(u.queryParams.date).format("YYYY-MM-DD"),this.tweetList=new this.Mao(this.date),this.tweetTotalNumber=0,o=this.$httpParamSerializer({date:this.date}),this.MaoService.countTweetByMaoTokenAndDate(o).then(function(t){return function(e){return t.tweetTotalNumber=e.data.count}}(this)),this.subscribe()}return t.prototype.getTweet=function(t){return this.date=this.TimeService.normalizeDate("days",t.date),this.tweetList=new this.Mao(this.date),void this.tweetList.load()},t.prototype.subscribe=function(){return this.$scope.$on("MaoStatusController::publish",function(t){return function(e,r){return t.date=r.date}}(this)),this.$scope.$on("termPagination::paginate",function(t){return function(e,r){t.$location.search("date",r.date),t.getTweet(r)}}(this))},t}(),MaoListContoller.$inject=["$location","$httpParamSerializer","$scope","Mao","MaoService","URLParameterChecker","TimeService"];var MaoRankingPostNumber;angular.module("myApp.directives").directive("maoRankingPostNumber",function(){return{restrict:"E",scope:{},template:'<section infinite-scroll="$ctrl.tweetCountList.load()" infinite-scroll-distance="0" class="row fillbars">\n\n  <div ng-repeat="item in $ctrl.tweetCountList.items" class="fillbar">\n\n    <div class="col-md-3 col-sm-3 col-xs-6 fillbar__user">\n      <img ng-src="{{item.postedBy.icon}}" twitter-id-str="{{item.postedBy.twitterIdStr}}" show-user-sidebar img-preload class="fade fillbar__icon">\n      <span class="fillbar__screen-name clickable" twitter-id-str="{{item.postedBy.twitterIdStr}}"  show-user-sidebar>{{item.postedBy.screenName}}</span>\n    </div>\n    <div class="col-md-9 col-sm-9 col-xs-6">\n      <div class="progress">\n        <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" ng-style="{ \'width\': item.postCount / $ctrl.tweetCountList.maxCount * 100 + \'%\'}">\n          <span class="fillbar__count">\n            {{item.postCount}}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="col-sm-12">\n    <dot-loader ng-if="$ctrl.tweetCountList.busy" class="infinitescroll-content">\n    </dot-loader>\n    <div ng-show="$ctrl.tweetCountList.isLast" class="text-center infinitescroll-content infinitescroll-message">終わりです\n    </div>\n  </div>\n\n</section>',bindToController:{},controllerAs:"$ctrl",controller:MaoRankingPostNumber}}),MaoRankingPostNumber=function(){function t(t){this.tweetCountList=new t}return t}(),MaoRankingPostNumber.$inject=["TweetCountList"];var MaoTweetArticleController;angular.module("myApp.directives").directive("maoTweetArticle",function(){return{restrict:"E",scope:{},template:'<div class="find__pict-tweet--container">\n  <div>\n    <div mao__user__container">\n      <div class="mao__pict__container">\n        <img ng-src="{{::$ctrl.item.media.media_url_https}}:small" data-img-src="{{::$ctrl.item.media.media_url_https}}" tweet-id-str="{{::$ctrl.item.tweet.id_str}}" show-statuses="show-statuses" img-preload class="fade find__pict-tweet--img">\n      </div>\n      <div class="media mao__user">\n        <a twitter-id-str="{{::$ctrl.item.tweet.user.id_str}}" show-user-sidebar="show-user-sidebar">\n          <img ng-src="{{::$ctrl.item.tweet.user.profile_image_url_https}}" img-preload="img-preload" class="mao__user__icon fade"/>\n        </a>\n        <div>\n          <h4 class="media-heading">\n            <span twitter-id-str="{{::$ctrl.item.tweet.user.id_str}}" show-user-sidebar class="mao__user__screen-name screen-name clickable">@{{::$ctrl.item.tweet.user.screen_name}}</span>\n          </h4>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>',bindToController:{item:"="},controllerAs:"$ctrl",controller:MaoTweetArticleController}}),MaoTweetArticleController=function(){function t(){}return t}();var GridLayoutTweet;angular.module("myApp.directives").directive("gridLayoutTweet",function(){return{restrict:"E",scope:{},template:'<div class="timeline__post--header timeline__post--header--grid">\n  <div class="timeline__post--header--info timeline__post--header--info--grid">\n    <div class="timeline__post--header--link timeline__post--header--link--grid">\n      <span twitter-id-str="{{::$ctrl.tweet.user.id_str}}" show-user-sidebar="show-user-sidebar" class="timeline__post--header--user timeline__post--header--user--grid clickable">{{::$ctrl.tweet.user.screen_name}}\n      </span><span ng-if="$ctrl.tweet.retweeted_status" class="timeline__post--header--rt_icon timeline__post--header--rt_icon--grid"><i class="fa fa-retweet"></i></span><a twitter-id-str="{{::$ctrl.tweet.retweeted_status.user.id_str}}" show-user-sidebar="show-user-sidebar" class="timeline__post--header--rt_source timeline__post--header--rt_source--grid">{{::$ctrl.tweet.retweeted_status.user.screen_name}}\n      </a>\n      <followable ng-if="!$ctrl.tweet.followStatus" list-id-str="{{$ctrl.listIdStr}}" tweet="{{$ctrl.tweet}}" follow-status="$ctrl.tweet.followStatus">\n      </followable>\n    </div>\n  </div>\n  <div class="timeline__post--header--time"><a href="https://{{::$ctrl.tweet.sourceUrl}}" target="_blank">{{::$ctrl.tweet.time}}\n    </a>\n  </div>\n</div>\n<div class="timeline__post--icon timeline__post--icon--grid"><img ng-src="{{::$ctrl.tweet.user.profile_image_url_https}}" img-preload="img-preload" show-user-sidebar="show-user-sidebar" twitter-id-str="{{::$ctrl.tweet.user.id_str}}" class="fade"/>\n</div>\n<div ng-repeat="picUrl in $ctrl.tweet.picUrlList" class="timeline__post--image timeline__post--image--grid">\n  <img ng-if="!$ctrl.tweet.video_url" ng-src="{{::picUrl}}" img-preload="img-preload" zoom-image="zoom-image" data-img-src="{{::picUrl}}" class="fade"/>\n  <video ng-if="$ctrl.tweet.video_url" poster="{{::picUrl}}" autoplay="autoplay" loop="loop" controls="controls" muted="muted">\n    <source ng-src="{{::$ctrl.tweet.video_url | trusted}}" type="video/mp4">\n    </source>\n  </video>\n</div>\n<div ng-if="!config.isShowOnlyImage" class="timeline__post__text__container">\n  <div ng-if="!$ctrl.tweet.retweeted_status" ng-bind-html="$ctrl.tweet.text | newlines" class="timeline__post--text timeline__post--text--grid">\n  </div>\n  <div ng-if="$ctrl.tweet.retweeted_status" class="timeline__post--blockquote timeline__post--blockquote--grid">\n    <p><a twitter-id-str="{{::$ctrl.tweet.retweeted_status.user.id_str}}" show-user-sidebar="show-user-sidebar">{{::$ctrl.tweet.retweeted_status.user.screen_name}}\n      </a>\n    </p>\n    <blockquote>\n      <div ng-bind-html="$ctrl.tweet.text | newlines" class="timeline__post--text">\n      </div>\n    </blockquote>\n  </div>\n</div>\n<div class="timeline__post--footer timeline__post--footer--grid">\n  <div class="timeline__post--footer--contents">\n    <div class="timeline__post--footer--contents--controls">\n      <i retweet-num="$ctrl.tweet.retweetNum" retweeted="$ctrl.tweet.retweeted" tweet-id-str="{{::$ctrl.tweet.tweetIdStr}}" retweetable="retweetable" class="fa fa-retweet icon-retweet">{{$ctrl.tweet.retweetNum}}</i>\n      <i fav-num="$ctrl.tweet.favNum" favorited="$ctrl.tweet.favorited" tweet-id-str="{{::$ctrl.tweet.tweetIdStr}}" favoritable="favoritable" class="fa fa-heart icon-heart">{{$ctrl.tweet.favNum}}</i>\n      <a>\n        <i data-url="{{::$ctrl.tweet.picOrigUrlList}}" filename="{{::$ctrl.tweet.fileName}}" download-from-url="download-from-url" class="fa fa-download"></i>\n      </a>\n    </div>\n  </div>\n</div>',bindToController:{tweet:"=",listIdStr:"="},controllerAs:"$ctrl",controller:GridLayoutTweet}}),GridLayoutTweet=function(){function t(){}return t}();var ListLayoutTweet;angular.module("myApp.directives").directive("listLayoutTweet",function(){return{restrict:"E",scope:{},template:'\n<div class="timeline__post--header">\n  <div class="timeline__post--header--info">\n    <div class="timeline__post--header--link">\n      <span twitter-id-str="{{::$ctrl.tweet.user.id_str}}" show-user-sidebar="show-user-sidebar" class="timeline__post--header--user clickable">{{::$ctrl.tweet.user.screen_name}}\n      </span>\n      <span ng-if="$ctrl.tweet.retweeted_status" class="timeline__post--header--rt_icon">\n        <i class="fa fa-retweet"></i>\n      </span>\n      <a twitter-id-str="{{::$ctrl.tweet.retweeted_status.user.id_str}}" show-user-sidebar="show-user-sidebar" class="timeline__post--header--rt_source">{{::$ctrl.tweet.retweeted_status.user.screen_name}}\n      </a>\n      <followable ng-if="!$ctrl.tweet.followStatus" list-id-str="{{$ctrl.listIdStr}}" tweet="{{$ctrl.tweet}}" follow-status="$ctrl.tweet.followStatus">\n      </followable>\n    </div>\n  </div>\n  <div class="timeline__post--header--time"><a href="https://{{::$ctrl.tweet.sourceUrl}}" target="_blank">{{::$ctrl.tweet.time}}\n    </a>\n  </div>\n</div>\n<div class="timeline__post--icon"><img ng-src="{{::$ctrl.tweet.user.profile_image_url_https}}" img-preload="img-preload" show-user-sidebar="show-user-sidebar" twitter-id-str="{{::$ctrl.tweet.user.id_str}}" class="fade"/>\n</div>\n<div ng-repeat="picUrl in $ctrl.tweet.picUrlList" class="timeline__post--image">\n  <img ng-if="!$ctrl.tweet.video_url" ng-src="{{::picUrl}}" img-preload="img-preload" zoom-image="zoom-image" data-img-src="{{::picUrl}}" class="fade"/>\n  <video ng-if="$ctrl.tweet.video_url" poster="{{::picUrl}}" autoplay="autoplay" loop="loop" controls="controls" muted="muted">\n    <source ng-src="{{::$ctrl.tweet.video_url | trusted}}" type="video/mp4">\n    </source>\n  </video>\n</div>\n<div ng-if="!config.isShowOnlyImage" class="timeline__post__text__container">\n  <div ng-if="!$ctrl.tweet.retweeted_status" ng-bind-html="$ctrl.tweet.text | newlines" class="timeline__post--text">\n  </div>\n  <div ng-if="$ctrl.tweet.retweeted_status" class="timeline__post--blockquote">\n    <p><a twitter-id-str="{{::$ctrl.tweet.retweeted_status.user.id_str}}" show-user-sidebar="show-user-sidebar">{{::$ctrl.tweet.retweeted_status.user.screen_name}}\n      </a>\n    </p>\n    <blockquote>\n      <div ng-bind-html="$ctrl.tweet.text | newlines" class="timeline__post--text">\n      </div>\n    </blockquote>\n  </div>\n</div>\n<div class="timeline__post--footer">\n  <div class="timeline__post--footer--contents">\n    <div class="timeline__post--footer--contents--controls">\n      <i retweet-num="$ctrl.tweet.retweetNum" retweeted="$ctrl.tweet.retweeted" tweet-id-str="{{::$ctrl.tweet.tweetIdStr}}" retweetable="retweetable" class="fa fa-retweet icon-retweet">{{$ctrl.tweet.retweetNum}}</i>\n      <i fav-num="$ctrl.tweet.favNum" favorited="$ctrl.tweet.favorited" tweet-id-str="{{::$ctrl.tweet.tweetIdStr}}" favoritable="favoritable" class="fa fa-heart icon-heart">{{$ctrl.tweet.favNum}}</i>\n      <a>\n        <i data-url="{{::$ctrl.tweet.extended_entities.media[0].media_url}}:orig" filename="{{::$ctrl.tweet.fileName}}" download-from-url="download-from-url" class="fa fa-download"></i>\n      </a>\n    </div>\n  </div>\n</div>\n',bindToController:{tweet:"=",listIdStr:"="},controllerAs:"$ctrl",controller:ListLayoutTweet}}),ListLayoutTweet=function(){function t(){}return t}();